<?xml version="1.0"?>

<!--Adapted from  F-4N by Dave Culp-->
<!--additionals for specific F-8E -->
<system name="holdback">

  <channel name="Holdback">
      
     
      <!--the force heading  of  the holdback according to the catapult heading  ( 180 deg back) -->      
      <summer name="Calculate HoldB Force X">
          <input>-external_reactions/catapult/x</input>
          <output>external_reactions/holdback/x</output>
      </summer>
      
      <summer name="Calculate HoldB Force Y">
          <input>-external_reactions/catapult/y</input>
          <output>external_reactions/holdback/y</output>
      </summer>
      
      
      
      <!-- Holdback We recalculate the side force which   should be applied during catapulting -->
     <!-- <summer name="external_reactions/hb-hold-side/x">
          <input>-external_reactions/holdback/y</input>
      </summer>
      
      <summer name="external_reactions/hb-hold-side/y">
          <input>external_reactions/holdback/x</input>
      </summer>-->
      
      
      
      <fcs_function name="Calculate HB Side Force ">
          <function>
              <sin>
                  <property>systems/carrier/cat-diff-head</property>
              </sin>
          </function>
          <output>systems/holdback/side-force</output>
      </fcs_function>
        
      
      
     
      
     
    <!-- holdback -->
    
    <pure_gain name="systems/holdback/total_thrust">
        <input>propulsion/engine/thrust-lbs</input>
        <gain>1.6</gain>
     </pure_gain>
     
     <switch name="systems/holdback/switch">
         <default value="0"/>
         <test value="1">
             systems/launchbar/lock-pos == 1
             launchbar/launch-bar-state == 1
         </test>
         <test value="0">
             gear/unit[1]/WOW == 0
         </test>
     </switch>
     
     <kinematic name="systems/holdback/switch-delay">
         <input>systems/holdback/switch</input>
         <traverse>
             <setting>
                 <position>0.0000</position>
                 <time>0.0000</time>
             </setting>
             <setting>
                 <position>1.0000</position>
                 <time>4</time>
             </setting>
         </traverse>
    </kinematic>
     
     <switch name="systems/holdback/magnitude">
         <default value="0"/>
         <test value="systems/holdback/total_thrust">
             systems/holdback/switch == 1
         </test>
         <output>external_reactions/holdback/magnitude</output>
     </switch>
     
     
     
     <!--This is the side force on the Holdback which will be applied accordingly to the calculated heading difference (see cat_external_data.xml file) -->
     
     <pure_gain name="systems/hb-hold-side/force2w">
         <input>-inertia/weight-lbs</input>
         <gain>3</gain>
    </pure_gain>
     
     <pure_gain name="systems/hb-hold-side/force">
         <input>systems/hb-hold-side/force2w</input>
         <gain>systems/holdback/side-force</gain>
    </pure_gain>
    
    <switch name="systems/hb-hold-side/magnitude">
        <default value="0"/>
        <test value="systems/hb-hold-side/force">
            systems/holdback/switch == 1
        </test>
        <output>external_reactions/hb-hold-side/magnitude</output>
     </switch>


  </channel>

</system>
