<?xml version="1.0"?>


<system name="">

    <channel name="launchbar">
        
        <property>launchbar/launch-bar-engage</property>
        
        <!--Lock/Unlock Launchbar-->
            <switch name="systems/launchbar/lock-pos">
                <default value="0"/>
                <test logic="AND" value="0">
                    systems/catapult/cat-launch-cmd == 1
                </test>
                <test logic="AND" value="1">
                    launchbar/launch-bar-engage == 1
                </test>
                <test logic="AND" value="systems/launchbar/lock-cmd">
                    systems/cat-onarea != 0
                </test>
            </switch>
       <!-- launchbar engage-->
            <switch name="systems/launchbar/switch">
                <default value="0"/>
                <test logic="AND" value="1">
                    systems/launchbar/lock-pos == 1
                </test>
                <test value="0">
                    gear/unit[1]/WOW == 0
                </test>
                <output>launchbar/launch-bar-engage</output>
            </switch>
            <!--launchbar, aircraft progressive repositioning delay and animation -->
             <kinematic name="Launchbar Engage">
                <input>launchbar/launch-bar-engage</input>
                <traverse>
                    <setting>
                        <position>0.0000</position>
                        <time>0.0000</time>
                    </setting>
                    <setting>
                        <position>1.0000</position>
                        <time>6.0000</time>
                    </setting>
                </traverse>
                <output>launchbar/launch-bar-pos-norm</output>
            </kinematic>
            <!--trigger to FlightGear , for message on screen-->
            <switch name="systems/launchbar/control">
                <default value="systems/launchbar/control"/>
                <test logic="AND" value="1">
                        launchbar/launch-bar-pos-norm == 1
                        gear/unit[1]/WOW == 1
                </test>
                 <test logic="AND" value="0">
                        systems/catapult/cat-final  == 0
                        gear/unit[1]/WOW == 0
                </test>
                <output>launchbar/launch-bar-state</output> 
            </switch>




           <!--Don't work with string values Done with Nasal-->
           <!-- <switch name="systems/launchbar/JBD-control">
                <default value="/sim/model/launchbar-state/engaged" />
                <test value="/sim/model/launchbar-state/engaged">
                        launchbar/launch-bar-state == 1
                </test>
                <output>/gear/launchbar/state</output>
            </switch>-->
            
            
            <!--forces in order to keep the aircraft sitting at the right Catapult position-->
            <!--an empiric value is calculated with "weight-lbs X delta-position X 300000   for each x and y coordinate--> 
            
            <pure_gain name="systems/tension/force_weight">
                <input>inertia/weight-lbs</input>
                <gain>50000</gain>
            </pure_gain>
            
            <switch name="systems/tension/force">
                <default value="0"/>
                <test logic="AND" value="systems/tension/force_weight">
                    launchbar/launch-bar-pos-norm gt 0
                    systems/launchbar/lock-pos == 1
                </test>
            </switch>
            
            <!-- Latitude     <force name="tensionx" frame="LOCAL"> -->
            <pure_gain name="systems/tension/forcex">
                <input>systems/tension/force</input>
                <gain>systems/carrier/cat-lat-diff-position</gain>
            </pure_gain>
            
            <pure_gain name="systems/tension/magnitudex">
                <input>systems/tension/forcex</input>
                <gain>launchbar/launch-bar-pos-norm</gain>
                <output>external_reactions/tensionx/magnitude</output>
            </pure_gain>
            
            <!-- Longitude    <force name="tensiony" frame="LOCAL"> -->
            <pure_gain name="systems/tension/forcey">
                <input>systems/tension/force</input>
                <gain>systems/carrier/cat-lon-diff-position</gain>
            </pure_gain>
            
            <pure_gain name="systems/tension/magnitudey">
                <input>systems/tension/forcey</input>
                <gain>launchbar/launch-bar-pos-norm</gain>
                <output>external_reactions/tensiony/magnitude</output>
            </pure_gain>
            
           


    </channel>

</system>
